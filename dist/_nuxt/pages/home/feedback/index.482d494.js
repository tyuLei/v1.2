(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{333:function(t,e,n){"use strict";(function(t){n(36),n(37),n(97),n(38),n(96),n(33),n(13),n(68),n(195);var o=n(347),r=n(338);e.a={data:function(){return{size:5,roleId:0,stateObj:{1:"启用",0:"禁用"},currentPage:1,treeData:[],defaultProps:{children:"children",label:"label"},routePathObj:{administration:"入驻工厂管理",feedback:"意见反馈"},formData:"",SERVIEC_URL_PATH:t.SERVIEC_URL_PATH}},mounted:function(){this.formData=new FormData},methods:{tableRowClassName:function(t){var e=t.row,n=t.rowIndex;e.index=n+1},rowClick:function(t){this.roleId=t.roleId},indexMethod:function(t){return t+1},onOptionBtn:function(t,e){this.$emit("".concat({"新增子类型":"onConfirmAdd","新增子角色":"onConfirmAdd","编辑":"onConfirmEdit","详情":"onConfirmDetails","删除":"onConfirmDel","通过":"onSuccess","不通过":"onUnSuc","启用":"onEnable","禁用":"onDisable","复用计划":"onEnable","停用计划":"onDisable","维保评价":"onEvaluate","查看评价":"onEvaluateDetails"}[t]),e)},exportExcel:function(){var t=this.$route.path.split("/"),e=this.routePathObj[t[t.length-1]],n=this.$cookies.get("user")&&this.$cookies.get("user").Authorization,o={method:"get",url:"".concat(this.SERVIEC_URL_PATH).concat(this.exportUrl),fileName:e,token:n,params:Object.keys(this.exportCond).length?this.exportCond:{}};Object(r.a)(o)},beforeUpload:function(t){this.formData=new FormData;var e=["xls"].includes(t.name.split(".")[1]);return e&&this.formData.append("file",t),e},importExcel:function(){var t=this;this.$axios.post(this.importUrl,this.formData).then((function(e){200==e.data.code?t.$message({message:"导入成功！",type:"success"}):t.$message({message:e.data.msg,type:"error"})}))},handleSizeChange:function(t){this.size=t,this.$emit("sizeChange",t)},handleCurrentChange:function(t){this.currentPage=t,this.$emit("currentChange",t)},setState:function(t,e,n,o){return 1==n?"启用":"禁用"},setDefault:function(t,e,n,o){return n},load:function(t,e,n){if(this.$emit("input",t.roleId||t.deviceTypeId),this.loadPath){var path="".concat(this.loadPath,"/").concat(t.roleId||t.deviceTypeId);this.$axios.get(path).then((function(t){if(200==t.data.code&&t.data.data&&t.data.data.length>0){var e=[];t.data.data.forEach((function(t){var n={};(n=t).hasChildren=!0,e.push(n)})),n(e)}else n([])}))}},getLazyInfo:function(t,e){this.$set(this.$refs.table.store.states.lazyTreeNodeMap,t,e)},setOption:function(t,e){var n=this.$route.path.split("/").length,o=this.$route.path.split("/")[n-1];return o||(o=this.$route.path.split("/")[n-2]),["administration","administration/"].includes(o)?2==e.factoryAuditStatus?1==e.factoryStatus?["禁用","编辑","详情"]:["启用","编辑","详情"]:1==e.factoryAuditStatus?["通过","不通过","详情"]:["详情"]:t}},props:["tableDefalutDataResouce","tableData","optionList","tableTotal","addText","loadPath","rowKey","exportUrl","importUrl","exportCond","tagList"],filters:{setTableValue:function(t,data,e){switch(t){case"factoryAuditStatus":return 0==e.factoryAuditStatus?"审核不通过":1==e.factoryAuditStatus?"待审核":e.factoryStatus?0==e.factoryStatus?"审核通过，已禁用":"审核通过，已启用":"审核通过，已禁用";case"feedbackType":switch(e.feedbackType){case 1:return"功能异常";case 2:return"优化建议";default:return"其他"}default:return e[data.prop]}}},components:{TreeSelectTemplate:o.a},watch:{loadPath:function(t){if(t)return t},rowKey:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){if(t)return rowKey})),exportUrl:function(t){if(t)return t},importUrl:function(t){if(t)return t},exportCond:function(t){if(t&&Object.keys(t).length)return t}}}}).call(this,n(14))},334:function(t,e,n){var content=n(340);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(35).default)("8d9e51c8",content,!0,{sourceMap:!1})},335:function(t,e,n){"use strict";n.r(e);var o=n(333).a,r=(n(339),n(32)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"common-table"},[n("div",{staticClass:"table-tools"},[["/home/feedback","/home/feedback/"].includes(t.$route.path)&&t.tagList.length?n("div",t._l(t.tagList,(function(e){return n("el-tag",{key:e.label,staticStyle:{"margin-right":"10px"},attrs:{"disable-transitions":"",type:e.type,effect:"plain"}},[t._v(t._s(e.label))])})),1):t._e(),t._v(" "),n("div",[["/home/administration","/home/administration/","/home/feedback","/home/feedback/"].includes(t.$route.path)?t._e():n("el-button",{attrs:{size:"medium",type:"primary",icon:"el-icon-plus"},on:{click:function(e){return t.$emit("create")}}},[t._v(t._s(t.addText||"新增"))])],1),t._v(" "),["/home/administration","/home/administration/"].includes(t.$route.path)?t._e():n("div",{staticStyle:{display:"flex"}},[n("el-button",{style:{"margin-right":"/home/feedback"==t.$route.path||"/home/feedback/"==t.$route.path?"0":"20px"},attrs:{size:"medium"},on:{click:function(e){return t.exportExcel()}}},[t._v("Excel导出")]),t._v(" "),n("el-upload",{staticClass:"upload-demo",attrs:{"show-file-list":!1,"before-upload":t.beforeUpload,"http-request":t.importExcel,action:"#"}},[["/home/feedback","/home/feedback/"].includes(t.$route.path)?t._e():n("el-button",{attrs:{type:"primary",size:"medium"}},[t._v("Excel导入")])],1)],1)]),t._v(" "),n("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{height:"350","row-key":t.rowKey,lazy:"",load:t.load,"tree-props":{children:"children",hasChildren:"hasChildren"},data:t.tableData,border:"","row-class-name":t.tableRowClassName},on:{"row-click":t.rowClick}},[n("el-table-column",{attrs:{type:"index",index:t.indexMethod}}),t._v(" "),t._l(t.tableDefalutDataResouce&&t.tableDefalutDataResouce,(function(data){return n("el-table-column",{key:data.label,attrs:{prop:data.prop,label:data.label,width:data.width,"show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t._f("setTableValue")(data.prop,data,e.row)))])]}}],null,!0)})})),t._v(" "),t.optionList&&t.optionList.length>0?n("el-table-column",{attrs:{fixed:"right",label:"操作",width:t.optionList&&60*t.optionList.length},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(t.setOption(t.optionList,e.row),(function(o){return n("el-button",{key:o,attrs:{type:"text",size:"small"},on:{click:function(n){return t.onOptionBtn(o,e.row)}}},[t._v(t._s(o))])}))}}],null,!1,2181852370)}):t._e()],2),t._v(" "),n("div",{staticClass:"block"},[n("div",{staticClass:"block",staticStyle:{"margin-left":"30%"}},[n("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-sizes":[5,10,15,20],"page-size":t.size,layout:"total, sizes, prev, pager, next, jumper",total:t.tableTotal},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])],1)}),[],!1,null,"60d1fe93",null);e.default=component.exports},338:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));n(33),n(13),n(68);var o=n(63),r=n.n(o);function l(data){var t=this;r()({method:data.method,url:data.url,responseType:"blob",headers:{Authorization:data.token},params:Object.keys(data.params).length?data.params:{}}).then((function(t){var link=document.createElement("a"),e=new Blob([t.data],{type:"application/vnd.ms-excel"});link.style.display="none",link.href=URL.createObjectURL(e),link.download=data.fileName,document.body.appendChild(link),link.click(),document.body.removeChild(link)})).catch((function(e){t.$Notice.error({title:"错误",desc:"网络连接错误"}),console.log(e)}))}},339:function(t,e,n){"use strict";var o=n(334);n.n(o).a},340:function(t,e,n){(e=n(34)(!1)).push([t.i,".common-table .table-tools[data-v-60d1fe93]{padding:15px 0;display:flex;justify-content:space-between}.common-table .el-table .el-tree[data-v-60d1fe93]{background:none!important}.common-table .block[data-v-60d1fe93]{display:flex;justify-content:flex-end;align-items:center;height:60px}",""]),t.exports=e},343:function(t,e,n){"use strict";(function(t){n(195),n(331),n(33),n(13),n(68);var o=n(335);e.a={data:function(){return{tableTotal:0,isDetails:!1,currentRowInfos:{},reqUrls:{export:"/bizFeedback/export",delete:"/bizFeedback/delete",all:"/bizFeedback/page"},pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-6048e5),t.$emit("pick",[n,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-2592e6),t.$emit("pick",[n,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-7776e6),t.$emit("pick",[n,e])}}],disabledDate:function(time){return!1}},params:{pageNum:1,pageSize:5},form:{feedbackPhone:"",feedbackName:"",factoryName:"",tastTime:"",feedbackType:0,feedbackDesc:""},tableDefalutDataResouce:[{prop:"feedbackPhone",label:"反馈人电话",width:"auto"},{prop:"feedbackName",label:"反馈人姓名",width:"auto"},{prop:"factoryName",label:"所在工厂",width:"auto"},{prop:"feedbackTime",label:"反馈时间",width:"auto"},{prop:"feedbackType",label:"意见类型",width:"auto"},{prop:"feedbackDesc",label:"意见描述",width:"auto"}],tableData:[],optionList:["详情","删除"],SERVIEC_URL_PATH:t.SERVIEC_URL_PATH,tagList:[]}},created:function(){this.init()},methods:{init:function(){var t=this;this.$axios.get(this.reqUrls.all,{params:this.params}).then((function(e){200==e.data.code&&(t.tableTotal=e.data.data.page.total,t.tableData=e.data.data.page.records,t.tagList=[{type:"",label:"功能异常：".concat(e.data.data.count.abnormalCount||0)},{type:"success",label:"优化建议：".concat(e.data.data.count.adviceCount||0)},{type:"info",label:"其他：".concat(e.data.data.count.otherCount||0)}])}))},onSearch:function(){var t=this,e={};Object.keys(this.form).forEach((function(n){if("tastTime"==n&&t.form[n]&&t.form[n].length){var o=new Date("".concat(t.form[n][0])),r=new Date("".concat(t.form[n][1]));return e.feedbackTimeStart="".concat(o.getFullYear(),"-").concat(String(o.getMonth()+1).padStart(2,0),"-").concat(String(o.getDate()).padStart(2,0)," ").concat(String(o.getHours()).padStart(2,0),":").concat(String(o.getMinutes()).padStart(2,0),":00"),void(e.feedbackTimeEnd="".concat(r.getFullYear(),"-").concat(String(r.getMonth()+1).padStart(2,0),"-").concat(String(r.getDate()).padStart(2,0)," 23:59:59"))}t.form[n]&&(e[n]=t.form[n])})),e.pageSize=this.params.pageSize,e.pageNum=this.params.pageNum,this.params=e,this.init()},onReset:function(t){this.form={feedbackPhone:"",feedbackName:"",factoryName:"",tastTime:"",feedbackType:0,feedbackDesc:""},this.params={pageNum:1,pageSize:this.params.pageSize},this.init()},sizeChange:function(t){this.params.pageSize=t,this.init()},currentChange:function(t){this.params.pageNum=t,this.init()},onRowClick:function(t){this.currentRowInfos=t,this.isDetails=!0},onConfirmDetails:function(t){this.onRowClick(t)},onConfirmDel:function(t){var e=this;this.$confirm("确定删除该条意见反馈信息吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$axios.delete("".concat(e.reqUrls.delete,"?id=").concat(t.id)).then((function(t){200==t.data.code?(e.$message({message:"删除成功！",type:"success"}),e.init()):e.$message({message:t.data.msg,type:"error"})}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},handleChange:function(){}},filters:{setImgList:function(t){if(t){var e=t.split(",")||[t.taskImgUrl];return e=e.map((function(t){return"".concat(SERVIEC_URL_PATH,"/").concat(t)}))}},setOpType:function(t){switch(t){case 1:return"功能异常";case 2:return"优化建议";case 3:return"其他";default:return"-"}}},components:{TableCommonTemplate:o.default}}}).call(this,n(14))},344:function(t,e,n){var content=n(358);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(35).default)("27dfc52b",content,!0,{sourceMap:!1})},347:function(t,e,n){"use strict";n(96),n(97);var o={data:function(){return{filterText:"",mineStatus:"",mineStatusValue:[],treeData:[],defaultProps:{children:"children",label:this.label},searchValue:"",params:{}}},created:function(){this.getRoleTree()},methods:{filterNode:function(t,data){return!t||-1!==data.label.indexOf(t)},getRoleTree:function(){var t=this;this.$axios.get(this.treePath,{params:this.params}).then((function(e){t.treeData=e.data.data}))},nodeClick:function(data){this.mineStatus||(this.mineStatus=[]),this.mineStatus.includes(data[this.label])||(this.mineStatus.push(data[this.label]),this.mineStatusValue.push(data),this.$emit("input",this.mineStatusValue))},removeTag:function(t){var e=this;this.mineStatus=this.mineStatus.filter((function(e){return e!=t})),this.mineStatusValue=this.mineStatusValue.filter((function(n){return n[e.label]!=t})),this.$emit("input",this.mineStatusValue)},selectChange:function(t){},setCheckedOpt:function(t){this.mineStatus=t},setCheckedInfo:function(t){this.mineStatusValue=t,this.$emit("input",this.mineStatusValue)},reset:function(){this.mineStatus="",this.mineStatusValue=[],this.$refs.tree.setCheckedKeys([])}},props:["label","treePath","loadPath","isShowFile"],watch:{label:function(t){if(t)return t},treePath:function(t){if(t)return t},loadPath:function(t){if(t)return t},filterText:function(t){t?this.params[this.label]=t:this.params={},this.getRoleTree()}}},r=n(32),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tree-select"},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",multiple:""},on:{change:t.selectChange,"remove-tag":t.removeTag},model:{value:t.mineStatus,callback:function(e){t.mineStatus=e},expression:"mineStatus"}},[t.isShowFile?n("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}}):t._e(),t._v(" "),n("el-option",{staticStyle:{height:"auto"},attrs:{value:t.mineStatusValue}},[n("el-tree",{ref:"tree",staticClass:"tree",attrs:{"node-key":"id","check-on-click-node":"",data:t.treeData,props:t.defaultProps,"expand-on-click-node":!1},on:{"node-click":t.nodeClick}})],1)],1)],1)}),[],!1,null,null,null);e.a=component.exports},357:function(t,e,n){"use strict";var o=n(344);n.n(o).a},358:function(t,e,n){(e=n(34)(!1)).push([t.i,".feedback[data-v-7f757119]{padding:10px;box-sizing:border-box}.feedback .search-block .search-form[data-v-7f757119]{width:100%;display:flex;justify-content:space-between;flex-wrap:wrap}.feedback .search-block .search-form .el-form-item[data-v-7f757119]{width:32%}",""]),t.exports=e},372:function(t,e,n){"use strict";n.r(e);var o=n(343).a,r=(n(357),n(32)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"feedback"},[n("el-dialog",{attrs:{title:"详情",visible:t.isDetails},on:{"update:visible":function(e){t.isDetails=e}}},[n("el-form",{attrs:{"label-position":"left"}},[n("el-form-item",{attrs:{label:"反馈人电话："}},[n("span",[t._v(t._s(t.currentRowInfos.feedbackPhone))])]),t._v(" "),n("el-form-item",{attrs:{label:"反馈人姓名："}},[n("span",[t._v(t._s(t.currentRowInfos.feedbackName))])]),t._v(" "),n("el-form-item",{attrs:{label:"所在工厂："}},[n("span",[t._v(t._s(t.currentRowInfos.factoryName))])]),t._v(" "),n("el-form-item",{attrs:{label:"反馈时间："}},[n("span",[t._v(t._s(t.currentRowInfos.feedbackTime||"-"))])]),t._v(" "),n("el-form-item",{attrs:{label:"意见类型："}},[n("span",[t._v(t._s(t._f("setOpType")(t.currentRowInfos.feedbackType)))])]),t._v(" "),n("el-form-item",{attrs:{label:"意见描述："}},[n("span",[t._v(t._s(t.currentRowInfos.feedbackDesc))])]),t._v(" "),n("el-form-item",{style:{display:"flex","flex-direction":t.currentRowInfos.feedbackImgSrc?"column":"row"},attrs:{label:"反馈图片："}},[t.currentRowInfos.feedbackImgSrc?n("div",{staticStyle:{display:"flex","flex-wrap":"wrap"}},t._l(t.currentRowInfos.feedbackImgSrc&&t.currentRowInfos.feedbackImgSrc.split(",")||[t.currentRowInfos.feedbackImgSrc],(function(e){return n("el-image",{key:e,staticStyle:{width:"100px",height:"100px",margin:"10px 10px 0 0","border-radius":"5px"},attrs:{src:t.SERVIEC_URL_PATH+"/"+e,fit:"fill","preview-src-list":t._f("setImgList")(t.currentRowInfos.feedbackImgSrc)}})})),1):n("div",[t._v("-")])])],1),t._v(" "),n("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.isDetails=!1}}},[t._v("关 闭")])],1)],1),t._v(" "),n("div",{staticClass:"search-block"},[n("el-form",{ref:"form",staticClass:"search-form",attrs:{"label-position":"left",model:t.form,"label-width":"auto"}},[n("el-form-item",{attrs:{label:"反馈人电话"}},[n("el-input",{attrs:{placeholder:"请输入反馈人电话"},model:{value:t.form.feedbackPhone,callback:function(e){t.$set(t.form,"feedbackPhone",e)},expression:"form.feedbackPhone"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"反馈人姓名"}},[n("el-input",{attrs:{placeholder:"请输入反馈人姓名"},model:{value:t.form.feedbackName,callback:function(e){t.$set(t.form,"feedbackName",e)},expression:"form.feedbackName"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"工厂名称"}},[n("el-input",{attrs:{placeholder:"请输入工厂名称"},model:{value:t.form.factoryName,callback:function(e){t.$set(t.form,"factoryName",e)},expression:"form.factoryName"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"反馈时间"}},[n("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions},model:{value:t.form.tastTime,callback:function(e){t.$set(t.form,"tastTime",e)},expression:"form.tastTime"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"意见类型"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择意见类型"},model:{value:t.form.feedbackType,callback:function(e){t.$set(t.form,"feedbackType",e)},expression:"form.feedbackType"}},[n("el-option",{attrs:{label:"全部",value:0}}),t._v(" "),n("el-option",{attrs:{label:"功能异常",value:1}}),t._v(" "),n("el-option",{attrs:{label:"优化建议",value:2}}),t._v(" "),n("el-option",{attrs:{label:"其他",value:3}})],1)],1),t._v(" "),n("el-form-item",{attrs:{label:"意见描述"}},[n("el-input",{attrs:{placeholder:"请输入意见描述"},model:{value:t.form.feedbackDesc,callback:function(e){t.$set(t.form,"feedbackDesc",e)},expression:"form.feedbackDesc"}})],1)],1)],1),t._v(" "),n("div",{staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(e){return t.onSearch()}}},[t._v("查询")]),t._v(" "),n("el-button",{attrs:{size:"medium"},on:{click:function(e){return t.onReset("form")}}},[t._v("重置")])],1),t._v(" "),n("TableCommonTemplate",{attrs:{tableDefalutDataResouce:t.tableDefalutDataResouce,tableData:t.tableData,optionList:t.optionList,tableTotal:t.tableTotal,exportUrl:t.reqUrls.export,exportCond:t.params,tagList:t.tagList},on:{excelSuc:function(e){return t.init()},sizeChange:function(e){return t.sizeChange(e)},currentChange:function(e){return t.currentChange(e)},onRowClick:function(e){return t.onRowClick(e)},onConfirmDetails:function(e){return t.onConfirmDetails(e)},onConfirmDel:function(e){return t.onConfirmDel(e)}}})],1)}),[],!1,null,"7f757119",null);e.default=component.exports;installComponents(component,{TableCommonTemplate:n(335).default})}}]);